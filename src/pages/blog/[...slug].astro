---
/**
 * Blog 單篇文章頁面 (blog/[...slug].astro)
 * 
 * 用途：
 * - 顯示單篇 Blog 文章的完整內容
 * - 動態生成所有 Blog 文章的頁面
 * - 使用 BlogPost 佈局提供統一的頁面風格
 * 
 * 路由：/blog/[文章-id]
 * 
 * 例如：
 * - /blog/my-first-post
 * - /blog/astro-tutorial
 */

import { type CollectionEntry, getCollection, render } from 'astro:content';
import BlogPost from '../../layouts/BlogPost.astro';

/**
 * 生成靜態路徑
 * Astro 會為每篇 Blog 文章生成一個靜態頁面
 */
export async function getStaticPaths() {
	// 獲取所有 Blog 文章
	const posts = await getCollection('blog');
	
	// 為每篇文章生成一個路由
	return posts.map((post) => ({
		params: { slug: post.id }, // URL 參數
		props: post, // 傳遞給組件的 Props
	}));
}

/** Blog 文章的類型定義 */
type Props = CollectionEntry<'blog'>;

/** 
 * 獲取當前文章數據
 * Astro 會根據 URL 自動傳遞正確的文章
 */
const post = Astro.props;

/** 渲染文章內容為 HTML */
const { Content } = await render(post);
---

{/* 使用 BlogPost 佈局顯示文章 */}
<BlogPost {...post.data}>
	{/* 文章內容 */}
	<Content />
</BlogPost>
